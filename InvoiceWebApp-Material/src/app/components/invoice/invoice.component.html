<mat-card class="content-card mat-elevation-z15">
    <mat-card-header>
        <mat-card-title class="text-center">
            <h2>Invoices</h2>

            <div id="search-form">
                <mat-form-field id="search" class="half-width-field">
                    <input matInput type="text" placeholder="Search" [(ngModel)]="query" />
                    <button mat-button *ngIf="query" matSuffix mat-icon-button aria-label="Clear" (click)="query='';">
                        <mat-icon>close</mat-icon>
                    </button>
                </mat-form-field>

                <button id="add-invoice-button" type="button" mat-flat-button color="primary" [routerLink]="['create']" title="Create invoice" class="mat-elevation-z3" [hidden]="currentUser.role_id == 2">
                    <mat-icon>note_add</mat-icon>
                </button>
            </div>

            <mat-divider></mat-divider>
        </mat-card-title>
    </mat-card-header>
    <mat-card-content>
        <form *ngIf="invoices">
            <table class="data-table" *ngIf="invoices?.length > 0">
                <thead>
                    <tr>
                        <th>Due date</th>
                        <th>Invoice Nr.</th>
                        <th>Total</th>
                        <th>Debtor</th>
                        <th>Paid</th>
                        <th>Concept</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let invoice of search()">
                        <td data-title="Due date">{{ invoice.expired_on | date: 'MMMM dd, yyyy' }}</td>
                        <td data-title="Invoice Nr.">
                            <a [routerLink]="['details', invoice.invoice_number]" title="View invoice details">
                                {{ settings.invoice_prefix }}{{ invoice.invoice_number }}
                            </a>
                        </td>
                        <td data-title="Total">
                            {{ getLocaleString(invoice.total) }}
                        </td>
                        <td data-title="Debtor">
                            {{ invoice.debtor.id }} - <span *ngIf="invoice.debtor.company_name == null">{{ invoice.debtor.first_name }} {{ invoice.debtor.last_name }}</span> <span *ngIf="invoice.debtor.company_name != null">{{ invoice.debtor.company_name }}</span>
                        </td>
                        <td data-title="Paid">
                            {{ invoice.is_paid == true ? 'Yes' : 'No' }}
                        </td>
                        <td data-title="Concept">
                            {{ invoice.concept == true ? 'Yes' : 'No' }}
                        </td>
                        <td data-title="">
                            <a mat-icon-button href="http://invoice.jhnbos.nl:90/api/invoices/pdf?invoice={{invoice.invoice_number}}" class="download-button" target="_blank" title="Open PDF">
                                <mat-icon>get_app</mat-icon>
                            </a>
                            <button mat-icon-button color="primary" class="edit-button" [routerLink]="['edit', invoice.invoice_number]" title="Edit" [hidden]="currentUser.role_id == 2">
                                <mat-icon>edit</mat-icon>
                            </button>
                            <button mat-icon-button color="primary" class="delete-button" type="button" (click)="deleteInvoice(invoice.invoice_number)" title="Remove" [hidden]="currentUser.role_id == 2">
                                <mat-icon>delete</mat-icon>
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </form>
    </mat-card-content>
</mat-card>